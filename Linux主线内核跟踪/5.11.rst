.. Kenneth Lee 版权所有 2021

:Authors: Kenneth Lee
:Version: 0.1

5.11
******

[1]_ 2021年2月14日发布。情人节。14,340个PatchSet，1912个开发者。

.. figure:: _static/kernel-4.11-version.png

大特性
======

AUX Bus
--------
看到这个名字我第一反应是：为什么不是平台设备？看完文档，我的答案是：平台设备是
系统总线的设备，而aux bus设备就是虚拟设备。比如过去HNS（Hisilicon Network
Subsystem）做了一个同时支持NIC和RoCE设备的公共框架HNAE，这样自己加很多额外的管
理要素，现在有了Aux Bus，我们只要把NIC和RoCE做成Aux总线设备，让HNAE提供这个总线
就可以了。

Intel加入的特性。

ARM平台支持KASan
----------------
Kernel Address Sanitizer是一个内存错误检测特性。这种工作都是代码不多但研究和测
试的工作特别多的。所以我们认为是一个大特性。

Linaro的工作成果。

todo

有趣的东西
===========

1. rwsem做了一个小修改，修复之前优化读写spinlock引入的一个很少会发生的连续读方
   取锁导致等待者无法唤醒的问题。

   Redhat做的修改。

2. 内核原来有一个命令行选项reboot的，可以设置重启动参数。本版本把这个参数修为可
   以动态修改，修改入口在/sysfs/kernel/reboot目录中。

   微软做的修改，这个特性有点像Windows服务器版本中的重启说明。最近做服务器市场
   发现，这种特性还是非常有必要的，因为用户的机器可能因为各种原因重启，但客户的
   管理层可能都认为是你的服务器不稳定。跟踪这些原因，你才能到现场马上发现问题是
   什么。

3. x86平台在vdso中增加了一个sigreturn的地址，没有细看原理，应该是配合一个系统调
   用重定向到用户态的特性的。我不关心这个细节，我关心的是，这是一种可能的优化方
   向：把部分非必要的系统调用移到用户态。比如gettimeofday这种，信息可以直接映射
   给用户态，但要说这种修改，我不如干脆把系统调用修改成vdso调用，所以，也就得个
   知字，不见得就有什么用了。

4. io_uring还是在做密集开发。

5. Intel在iommu驱动中做了一点修改，可以动态修改default iommu domain。iommu
   domain表示一套页表管理（包括它的管理算法），保留一个default domain可以在vfio
   不在管理这个iommu的时候，可以让原来的dma算法回到过去的模式。可以修改这个意味
   着iommu可以接受不同的默认管理模式。

6. Intel QAT引擎还在不断增加新的算法支持，主要还是非对称的，比如AES-CTR/XTS。


华为和海思的相关特性
====================

1. John Garry在1620的PMU驱动中加了几个uncore的事件控制。

2. 钱伟丽调整了1620和1630硬件随机数驱动。

3. 罗嘉兴加了一个海思通用GPIO驱动。基于ACPI配置。

值得关注中的进行中特性
=======================

maple树
--------


参考
====
.. [1] https://kernelnewbies.org/LinuxChanges

